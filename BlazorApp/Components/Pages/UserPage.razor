@page "/u/{Username}"
@using BlazorApp.Models;

@if (User == null)
{
	<ErrorPage Status="404" />
}
else if (User.Username != null)
{
	<div class="card shadow">
		<h1 class="card-header">@User.FirstName @User.LastName</h1>
		<div class="card-body">
			@User.CreatedAt.ToShortDateString()
		</div>
		<h3 class="card-header border-top">Books for sale.</h3>
		<div class="card-body">
			<div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-3">
				@foreach (Book book in Books)
				{
					<BookComponent book="book"></BookComponent>
				}

			</div>
		</div>
		<div class="card-footer">
		</div>
	</div>
}

@code {
	[Parameter]
	public string Username { get; set; }

	private User User = new User();
	private ModelList<Book> Books = new ModelList<Book>();

	protected override async Task OnInitializedAsync()
	{
		ModelList<User> users = await User.QueryBy(("username", Username));
		User = users.FirstOrDefault();
		Books = await User.GetBooks();
	}
}
